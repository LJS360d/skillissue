/*
(c) 2013-2022 GameMix Inc. All rights reserved.
*/
!function()
{var requestAnimFrame=window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},cancelAnimFrame=window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(){window.clearTimeout.apply(window,arguments)},console=(navigator.vibrate=navigator.vibrate||navigator.mozVibrate||navigator.webkitVibrate||navigator.oVibrate||navigator.msVibrate||(navigator.notification?function(e){navigator.notification.vibrate(e)}:null)||new Function,window.console||{log:new Function,debug:new Function,warn:new Function,error:new Function,clear:new Function}),DOM={get:function(e){return null==(r=e==document||e==window||e instanceof HTMLElement?e:document.getElementById(e))&&console.log(e),r},attr:function(e,t,i){if(!i)return this.get(e).getAttribute(t);this.get(e).setAttribute(t,i)},on:function(e,t,i){var n,o=t.split(" ");for(n in o)this.get(e).addEventListener(o[n],i,!1)},un:function(e,t,i){var n,o=t.split(" ");for(n in o)this.get(e).removeEventListener(o[n],i,!1)},show:function(e){this.get(e).style.display="block"},hide:function(e){this.get(e).style.display="none"},offset:function(e){return{x:(e=this.get(e)).clientLeft+window.scrollLeft,y:e.clientTop+window.scrollTop}},query:function(e){return document.querySelectorAll?document.querySelectorAll(e):null},queryOne:function(e){return document.querySelector?document.querySelector(e):null},create:function(e){return document.createElement(e)},positionRelativeTo:function(e,t,i){e=DOM.offset(e);return{x:t-e.x,y:i-e.y}},fitScreen:function(e,t){var i,n;return window.innerWidth/window.innerHeight<=t?n=(i=window.innerWidth)/t:i=(n=window.innerHeight)*t,(e=DOM.get(e)).style.width=i+"px",e.style.height=n+"px",{width:i,height:n}},saveCanvas:function(e){var e=this.get(e),t=this.create("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t},fadeIn:function(e,t,i){e=this.get(e),t=t||1e3,this.show(e),e.style.opacity=0,Util.interpolate(e.style,{opacity:1},t,i)},fadeOut:function(e,t,i){e=this.get(e),t=t||1e3,this.show(e),e.style.opacity=1,Util.interpolate(e.style,{opacity:0},t,function(){DOM.hide(e),i&&i()})},notify:function(e,t,i){var n;i=i?this.get(i):document.body,this.notification=this.notification||(n=DOM.create("div"),i.appendChild(n),DOM.applyStyle(n,{zIndex:999999,position:"absolute",bottom:"10px",width:"100%",textAlign:"center"}),i=DOM.create("span"),n.appendChild(i),DOM.applyStyle(i,{backgroundColor:"rgba(0,0,0,0.7)",border:"1px solid white",borderRadius:"3px",margin:"auto",color:"white",padding:"2px",paddingLeft:"10px",paddingRight:"10px",width:"50%",fontSize:"0.7em",boxShadow:"0px 0px 2px black"}),{block:n,message:i,queue:[],add:function(e,t){this.queue.push({message:e,duration:t}),1==this.queue.length&&this.applyOne()},applyOne:function(){var e=this.queue[0];this.message.innerHTML=e.message,DOM.fadeIn(this.block,500),setTimeout(function(){DOM.fadeOut(DOM.notification.block,500,function(){DOM.notification.queue.shift(),0<DOM.notification.queue.length&&DOM.notification.applyOne()})},e.duration+500)}}),this.notification.add(e,t=t||3e3)},applyStyle:function(e,t){for(var i in e=this.get(e),t)e.style[i]=t[i]},populate:function(e){var t,i={};for(t in e)i[t]=DOM.get(e[t]),i[t]||console.log("Element #"+e[t]+" not found");return i}},Util={preload:function(e,t,i,n){function o(){var e,t;0==s.length?a(c):((e=new Image).onerror=function(){console.log("Couldn't load "+t),h(t)},e.onload=function(){this.complete&&(r(this,1-s.length/l),setTimeout(o,0<=document.location.search.indexOf("fakelag")?1e3:1))},t=s.pop(),e.src=t,c[t]=e)}var s=e.slice(0),a=i||new Function,r=t||new Function,h=n||new Function,l=s.length,c={};setTimeout(o,1)},rand:function(e,t){return Math.random()*(t-e)+e},randomPick:function(){return arguments[parseInt(Util.rand(0,arguments.length))]},limit:function(e,t,i){return e<t?t:i<e?i:e},sign:function(e){return 0<e?1:0==e?0:-1},cookie:{set:function(e,t,i){null==i&&(i=31536e6),document.cookie=e+"=;path=/;expires=Thu, 01-Jan-1970 00:00:01 GMT";var n=new Date;n.setTime(n.getTime()+i),document.cookie=[e+"="+t+"; ","expires="+n.toGMTString()+"; ","path=/"].join("")},get:function(e){var t,i=document.cookie.split("; ");for(t in i){var n=i[t].split("=");if(2==n.length&&n[0]==e)return n[1]}}},storage:window.localStorage?{getItem:function(e){return window.localStorage.getItem(e)},setItem:function(e,t){try{window.localStorage.setItem(e,t)}catch(e){console.log("Local storage issue: "+e)}}}:{getItem:function(e){return Util.cookie.get(e)},setItem:function(e,t){Util.cookie.set(e,t)}},merge:function(e,t){if(!t)return e;for(var i in e)i in t?"object"!=typeof e[i]||t[i]instanceof Array||(t[i]=arguments.callee.call(this,e[i],t[i])):t[i]=e[i];return t},copyObject:function(e){var t,i={};for(t in e)i[t]=e[t];return i},isTouchScreen:function(){var e="orientation"in window||"orientation"in window.screen||"mozOrientation"in window.screen||"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||"ontouchstart"in document.documentElement;return(e=e&&Detect.isMobile())||0<=window.location.search.indexOf("touch")},distance:function(e,t,i,n){return Math.sqrt((e-i)*(e-i)+(t-n)*(t-n))},arrayUnique:function(e){for(var t=0;t<e.length;t++)for(var i=t+1;e[i];)e[t]==e[i]?e.splice(i,1):i++},analyzeParameters:function(){for(var e,t={},i=window.location.search.substr(1).split("&"),n=0;n<i.length;n++)t[(e=i[n].split("="))[0]]=e[1];return t},interpolate:function(n,o,s,a){var e,r={};for(e in o)r[e]=parseFloat(n[e]);var h=Date.now();!function(){var e,t=Date.now(),i=Math.min(1,(t-h)/s);for(e in o)n[e]=i*(o[e]-r[e])+r[e];i<1?requestAnimFrame(arguments.callee):a&&a.call(n)}()},addZeros:function(e,t){for(var i=e.toString();i.length<t;)i="0"+i;return i},formatDate:function(e,t,i){t=t||new Date,i=Util.merge({months:["January","February","March","April","May","June","August","September","October","November","December"]},i);for(var n="",o=!1,s=0;s<e.length;s++)if("%"==e.charAt(s))o=!0;else if(o)switch(o=!1,e.charAt(s)){case"%":n+="%";break;case"M":n+=i.months[t.getMonth()];break;case"d":n+=t.getDate();break;case"Y":n+=t.getFullYear();break;case"m":n+=t.getMonth()}else n+=e.charAt(s);return n},keyOf:function(e,t){for(var i in e)if(e[i]==t)return i;return null}},Ajax={send:function(e,t,i,n,o){var s;if(window.XMLHttpRequest)s=new XMLHttpRequest;else{if(!window.ActiveXObject)return console.log("AJAX not supported by your browser."),!1;try{s=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){s=new ActiveXObject("Microsoft.XMLHTTP")}}n=n||new Function,o=o||new Function,t=t.toUpperCase();var a,r=[];for(a in i=i||{})r.push(a+"="+i[a]);var h=r.join("&");"GET"==t&&(e+="?"+h),s.open(t,e,!0),s.onreadystatechange=function(){4==s.readyState&&(200!=s.status?o:n)(s.status,s.responseText)},"POST"==t?(s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(h)):s.send(null)}},ArrayManager={elements:[],arrays:[],remove:function(e,t){this.arrays.push(e),this.elements.push(t)},flush:function(){var e,t;for(t in this.arrays)0<=(e=this.arrays[t].indexOf(this.elements[t]))&&this.arrays[t].splice(e,1);this.arrays=[],this.elements=[]},init:function(){this.arrays=[],this.elements=[]}},Encoder={buildString:function(e){var t,i="";for(t in e)i+=t+"="+e[t].toString().replace(/=/g," ").replace(/\|/g," ")+"|";return i},encode:function(e){var e=Encoder.buildString(e),t=~~Util.rand(1,255),e=Encoder.encodeString(e,t);return encodeURIComponent(e)},encodeString:function(e,t){for(var i,n="",o=0;o<e.length;o++)i=e.charCodeAt(o),n+=String.fromCharCode((i+t)%256);return n=String.fromCharCode(t)+n}},Detect={agent:navigator.userAgent.toLowerCase(),isMobile:function(){return this.isAndroid()||this.isFirefoxOS()||this.isWindowsMobile()||this.isIOS()},isAndroid:function(){return 0<=this.agent.indexOf("android")},isFirefoxOS:function(){return!this.isAndroid()&&0<=this.agent.indexOf("firefox")&&0<=this.agent.indexOf("mobile")},isIOS:function(){return 0<=this.agent.indexOf("ios")||0<=this.agent.indexOf("ipod")||0<=this.agent.indexOf("ipad")||0<=this.agent.indexOf("iphone")},isWindowsMobile:function(){return 0<=this.agent.indexOf("windows")&&0<=this.agent.indexOf("mobile")||0<=this.agent.indexOf("iemobile")},isTizen:function(){return 0<=this.agent.indexOf("tizen")}},resourceManager={processImages:function(e){var t=DOM.create("canvas").getContext("2d");if(resources.folder=resources.folder||"",R.image=R.image||{},resources.image)for(var i in resources.image)R.image[i]=e[resources.folder+resources.image[i]];if(R.pattern=R.pattern||{},resources.pattern)for(var i in resources.pattern)R.pattern[i]=t.createPattern(e[resources.folder+resources.pattern[i]],"repeat");if(R.sprite=R.sprite||{},resources.sprite)for(var i in resources.sprite)R.sprite[i]=this.createSprite(e[resources.folder+resources.sprite[i].sheet],resources.sprite[i]),resources.sprite[i].pattern&&(R.pattern[i]=t.createPattern(R.sprite[i],"repeat"));if(R.animation=R.animation||{},resources.animation)for(var i in resources.animation){R.animation[i]=[];for(var n=0;n<resources.animation[i].length;n++)R.sprite[resources.animation[i][n]]?R.animation[i].push(R.sprite[resources.animation[i][n]]):console.log("Error for animation "+i+': sprite "'+resources.animation[i][n]+'" not found')}if(R.raw=R.raw||{},resources.raw)for(var i in resources.raw)R.raw[i]=resources.raw[i]instanceof Function?resources.raw[i]():resources.raw[i];if(R.string=R.string||{},resources.string){var o,s=this.getLanguage(resources.string);for(i in resources.string[s]||(o=function(e){if("string"!=typeof e){var t,i={};for(t in e)"string"==typeof e[t]?i[t]="{"+t+"}":i[t]=o(e[t]);return i}},resources.string[s]=o(resources.string.en)),resources.string[s])R.string[i]=resources.string[s][i];for(i in R.string)if("$"==i.charAt(0))try{DOM.get(i.substring(1)).innerHTML=R.string[i]}catch(e){console.log("DOM element "+i+" does not exist")}}resourceManager=resources=null},createSprite:function(e,t){var i=DOM.create("canvas"),n=i.getContext("2d");return i.width=t.width,i.height=t.height,n.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height),i},getNecessaryImages:function(){var e,t=[];for(e in resources.image)t.push(resources.folder+resources.image[e]);for(e in resources.pattern)t.push(resources.folder+resources.pattern[e]);for(e in resources.sprite)t.push(resources.folder+resources.sprite[e].sheet);return Util.arrayUnique(t),t},getLanguage:function(e){var t,i=null,n=null,o=Util.analyzeParameters();if(o.lang)return o.lang;for(t in!(n=navigator&&navigator.userAgent&&(n=navigator.userAgent.match(/android.*\W(\w\w)-(\w\w)\W/i))?n[1]:n)&&navigator&&(navigator.language?n=navigator.language:navigator.browserLanguage?n=navigator.browserLanguage:navigator.systemLanguage?n=navigator.systemLanguage:navigator.userLanguage&&(n=navigator.userLanguage),n=n.substr(0,2)),e){if(0<=n.indexOf(t)){i=t;break}i=i||t}return i}},cycleManager={init:function(e,t){var i,n;this.pause=!1,this.oncycle=e,void 0!==document.hidden?(i="hidden",n="visibilitychange"):void 0!==document.mozHidden?(i="mozHidden",n="mozvisibilitychange"):void 0!==document.msHidden?(i="msHidden",n="msvisibilitychange"):void 0!==document.webkitHidden&&(i="webkitHidden",n="webkitvisibilitychange"),this.focus=!0,i?DOM.on(document,n,function(){cycleManager.focus=!document[i]}):(DOM.on(window,"focus",function(){cycleManager.focus=!0}),DOM.on(window,"blur",function(){cycleManager.focus=!1})),this.lastCycle=Date.now(),this.fpsMin=t||10,this.framesUntilNextStat=0,this.lastStat=0,this.fakeLag=0<=document.location.search.indexOf("fakelag"),this.fps=0,this.requestId=null,this.init=null,this.resume(),window.kik&&kik.browser&&kik.browser.on&&(kik.browser.on("background",function(){cycleManager.stop()}),kik.browser.on("foreground",function(){cycleManager.resume()}))},stop:function(){this.pause=!0,cancelAnimFrame(this.requestId)},resume:function(){this.pause=!1,cancelAnimFrame(this.requestId),function(){cycleManager.cycle(),cycleManager.requestId=requestAnimFrame(arguments.callee)}()},cycle:function(){var e=Date.now(),t=Math.min((e-this.lastCycle)/1e3,1/this.fpsMin);if(this.lastCycle=e,!this.pause){try{this.oncycle(t)}catch(e){console.log("Error: "+e+" - ")}this.framesUntilNextStat--,this.framesUntilNextStat<=0&&(this.framesUntilNextStat=60,this.fps=~~(6e4/(Date.now()-this.lastStat+t)),this.lastStat=Date.now())}}},resizer={init:function(e,t,i,n){this.enabled=Util.isTouchScreen()||n,this.targetWidth=e,this.targetHeight=t,this.element=i,this.dimensions={width:e,height:t},this.scale=1,(Util.isTouchScreen()||n)&&(DOM.on(window,"resize orientationchange",function(){resizer.resize()}),this.resize(),this.toResize=null),this.init=null},resize:function(){!this.toResize&&this.enabled&&(this.toResize=setTimeout(function(){resizer.enabled&&(window.scrollTo(0,1),resizer.toResize=null,resizer.dimensions=DOM.fitScreen(resizer.element,resizer.targetWidth/resizer.targetHeight),resizer.scale=resizer.dimensions.height/resizer.targetHeight)},1e3))}};function extend(e,t){if(!e.extends||!e.extends[t]){for(var i in t.prototype)e.prototype[i]||(e.prototype[i]=t.prototype[i]);e.extends=e.extends||{},e.extends[t]=!0}}function extendPrototype(e,t){var i,n={};for(i in e.prototype)n[i]=e.prototype[i];for(i in t)n[i]=t[i];return n}function ResourceLoader(e){this.settings=e,this.appCache=window.applicationCache,this.finished=!1,this.message=null}function Resizer(e){this.delay=e.delay||0,this.element=e.element||null,this.baseWidth=e.baseWidth,this.baseHeight=e.baseHeight,this.onResize=e.onResize,this.enabled=!0,this.resizeTimeout=null}function Area(e,t,i,n,o){this.x=e,this.y=t,this.width=i,this.height=n,this.enabled=!0,this.onactionperformed=(o=o||{}).actionPerformed,this.onactionstart=o.actionStart,this.onactioncancel=o.actionCancel}function Screen(e){this.game=e,this.areas=[],this.currentActionArea=null,this.view=null}function DisplayableObject(){this.parent=null,this.x=this.y=0,this.rotation=0,this.scaleX=this.scaleY=1,this.alpha=1,this.visible=!0}function DisplayableContainer(){DisplayableObject.call(this),this.children=[]}function DisplayableRectangle(){DisplayableContainer.call(this),this.color="#000",this.width=0,this.height=0}function DisplayableShape(e){DisplayableObject.call(this),this.drawFunction=e}function DisplayableTextField(){DisplayableObject.call(this),this.text=null,this.font="12pt Arial",this.textAlign="left",this.textBaseline="top",this.color="#000",this.shadowColor=null,this.shadowOffsetX=0,this.shadowOffsetY=0}function DisplayableImage(){DisplayableObject.call(this),this.image=null,this.anchorX=this.anchorY=0}function Tween(e,t,i,n,o,s,a){this.object=e,this.delayLeft=s||0,this.duration=o,this.elapsed=0,this.property=t,this.from=i,this.to=n,this.onFinish=a,this.finished=!1,e[t]=i}window.cordova&&document.addEventListener("deviceready",function(){cordova.exec(null,null,"SplashScreen","hide",[]),DOM.notify('More HTML5 games available at <a style="color:white" href="'+GameParams.moregamesurl+'">'+GameParams.moregamesurl+"</a>",3e3)},!1),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function t(){return n.apply(this instanceof o&&e?this:e,i.concat(Array.prototype.slice.call(arguments)))}var i=Array.prototype.slice.call(arguments,1),n=this,o=function(){};return o.prototype=this.prototype,t.prototype=new o,t}),window.originalOpen=window.open,Number.prototype.mod=function(e){return(this%e+e)%e},ResourceLoader.prototype.load=function(e,t){this.endCallback=e,this.canvasOutput=t,this.appCache&&this.appCache.status!==this.appCache.UNCACHED?this.loadCache():this.loadResources()},ResourceLoader.prototype.loadCache=function(){if(this.message="Updating...",this.appCache.addEventListener("checking",this.checkingCache.bind(this),!1),this.appCache.addEventListener("noupdate",this.loadResources.bind(this),!1),this.appCache.addEventListener("obsolete",this.loadResources.bind(this),!1),this.appCache.addEventListener("error",this.loadResources.bind(this),!1),this.appCache.addEventListener("cached",this.loadResources.bind(this),!1),this.appCache.addEventListener("downloading",this.updatingCache.bind(this),!1),this.appCache.addEventListener("progress",this.updatingCacheProgress.bind(this),!1),this.appCache.addEventListener("updateready",this.updatingCacheReady.bind(this),!1),this.appCache.status===this.appCache.IDLE)try{this.appCache.update()}catch(e){this.loadResources()}},ResourceLoader.prototype.checkingCache=function(){this.finished||this.showProgress(this.canvasOutput,0)},ResourceLoader.prototype.updatingCache=function(e){this.canvasOutput&&!this.finished&&this.showProgress(this.canvasOutput,0)},ResourceLoader.prototype.updatingCacheProgress=function(e){this.canvasOutput&&!this.finished&&this.showProgress(this.canvasOutput,e.loaded/e.total||0)},ResourceLoader.prototype.updatingCacheReady=function(e){if(!this.finished){this.finished=!0;try{this.appCache.swapCache()}catch(e){}location.reload()}},ResourceLoader.prototype.loadResources=function(){this.message="Loading assets. Please wait...",this.R={},this.processLanguage(this.R);var e=this.getNecessaryImages();Util.preload(e,this.resourcesProgress.bind(this),this.resourcesLoaded.bind(this),this.resourcesError.bind(this))},ResourceLoader.prototype.resourcesError=function(e){alert("Could not load "+e+".\nUnable to launch.")},ResourceLoader.prototype.resourcesProgress=function(e,t){this.canvasOutput&&!this.finished&&this.showProgress(this.canvasOutput,t)},ResourceLoader.prototype.resourcesLoaded=function(e){this.finished||(this.finished=!0,this.processImages(e,this.R),this.endCallback(this.R))},ResourceLoader.prototype.showProgress=function(e,t){var i=e.getContext("2d");i.fillStyle="#000",i.fillRect(0,0,e.width,e.height),i.font="10px Arial",i.fillStyle="gray",i.textAlign="center",i.textBaseline="middle",i.fillText(this.message,e.width/2,e.height/2-20),i.fillRect(0,e.height/2-5,e.width,10),i.fillStyle="white",i.fillRect(0,e.height/2-5,t*e.width,10),i.fillStyle="black",i.textAlign="right",i.fillText(~~(100*t)+"%",t*e.width-2,e.height/2)},ResourceLoader.prototype.createSprite=function(e,t){var i=document.createElement("canvas"),n=i.getContext("2d");return i.width=t.width,i.height=t.height,n.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height),i},ResourceLoader.prototype.getNecessaryImages=function(){var e,t=[];for(e in this.settings.image)t.push(this.settings.folder+this.settings.image[e]);for(e in this.settings.pattern)t.push(this.settings.folder+this.settings.pattern[e]);for(e in this.settings.sprite)t.push(this.settings.folder+this.settings.sprite[e].sheet);return Util.arrayUnique(t),t},ResourceLoader.prototype.getLanguage=function(e){var t,i=null,n=null,o=Util.analyzeParameters();if(o.lang)return o.lang;for(t in!(n=navigator&&navigator.userAgent&&(n=navigator.userAgent.match(/android.*\W(\w\w)-(\w\w)\W/i))?n[1]:n)&&navigator&&(navigator.language?n=navigator.language:navigator.browserLanguage?n=navigator.browserLanguage:navigator.systemLanguage?n=navigator.systemLanguage:navigator.userLanguage&&(n=navigator.userLanguage),n=n.substr(0,2)),e){if(0<=n.indexOf(t)){i=t;break}i=i||t}return i},ResourceLoader.prototype.processImages=function(e,t){var i=DOM.create("canvas").getContext("2d");if(this.settings.folder=this.settings.folder||"",t.image=t.image||{},this.settings.image)for(var n in this.settings.image)t.image[n]=e[this.settings.folder+this.settings.image[n]];if(t.pattern=t.pattern||{},this.settings.pattern)for(var n in this.settings.pattern)t.pattern[n]=i.createPattern(e[this.settings.folder+this.settings.pattern[n]],"repeat"),t.pattern[n].width=e[this.settings.folder+this.settings.pattern[n]].width,t.pattern[n].height=e[this.settings.folder+this.settings.pattern[n]].height;if(t.sprite=t.sprite||{},this.settings.sprite)for(var n in this.settings.sprite)t.sprite[n]=this.createSprite(e[this.settings.folder+this.settings.sprite[n].sheet],this.settings.sprite[n]),this.settings.sprite[n].pattern&&(t.pattern[n]=i.createPattern(t.sprite[n],"repeat"),t.pattern[n].width=t.sprite[n].width,t.pattern[n].height=t.sprite[n].height);if(t.animation=t.animation||{},this.settings.animation)for(var n in this.settings.animation){t.animation[n]=[];for(var o=0;o<this.settings.animation[n].length;o++)t.sprite[this.settings.animation[n][o]]?t.animation[n].push(t.sprite[this.settings.animation[n][o]]):console.log("Error for animation "+n+': sprite "'+this.settings.animation[n][o]+'" not found')}if(t.raw=t.raw||{},this.settings.raw)for(var n in this.settings.raw)t.raw[n]=this.settings.raw[n]instanceof Function?this.settings.raw[n]():this.settings.raw[n]},ResourceLoader.prototype.processLanguage=function(e){if(e.string=e.string||{},this.settings.string){var n,t;for(t in this.language=this.getLanguage(this.settings.string),this.settings.string[this.language]||(n=function(e){if("string"!=typeof e){var t,i={};for(t in e)"string"==typeof e[t]?i[t]="{"+t+"}":i[t]=n(e[t]);return i}},this.settings.string[this.language]=n(this.settings.string.en)),this.settings.string[this.language])e.string[t]=this.settings.string[this.language][t];for(t in e.string)if("$"==t.charAt(0))try{DOM.get(t.substring(1)).innerHTML=e.string[t]}catch(e){console.log("DOM element "+t+" does not exist")}}},Resizer.prototype={needsResize:function(e,t){clearTimeout(this.resizeTimeout),this.enabled&&(this.maxWidth=e,this.maxHeight=t,this.resizeTimeout=setTimeout(this.resize.bind(this),this.delay))},resize:function(){this.resizeTimeout=null;var e=this.getFittingDimensions(this.maxWidth,this.maxHeight);this.element.style.width=e.width+"px",this.element.style.height=e.height+"px",this.onResize&&this.onResize.call(this)},scaleX:function(){return parseInt(this.element.style.width)/this.baseWidth||1},scaleY:function(){return parseInt(this.element.style.height)/this.baseHeight||1},getFittingDimensions:function(e,t){var i,n,o=e/t,s=this.baseWidth/this.baseHeight;return Math.abs(o-s)<=.1?(i=e,n=t):o<=s?n=(i=e)/s:i=(n=t)*s,{width:i,height:n}}},!function(){var o,r={},w=null,s=!0,h=!1;try{"undefined"!=typeof AudioContext?w=new AudioContext:"undefined"!=typeof webkitAudioContext?w=new webkitAudioContext:s=!1}catch(e){s=!1}if(!s)if("undefined"!=typeof Audio)try{new Audio}catch(e){h=!0}else h=!0;s&&((o=void 0===w.createGain?w.createGainNode():w.createGain()).gain.value=1,o.connect(w.destination));function l(){this._volume=1,this._muted=!1,this.usingWebAudio=s,this.noAudio=h,this._howls=[]}function e(e){var t=this;t._autoplay=e.autoplay||!1,t._buffer=e.buffer||!1,t._duration=e.duration||0,t._format=e.format||null,t._loop=e.loop||!1,t._loaded=!1,t._sprite=e.sprite||{},t._src=e.src||"",t._pos3d=e.pos3d||[0,0,-.5],t._volume=void 0!==e.volume?e.volume:1,t._urls=e.urls||[],t._rate=e.rate||1,t._model=e.model||null,t._onload=[e.onload||function(){}],t._onloaderror=[e.onloaderror||function(){}],t._onend=[e.onend||function(){}],t._onpause=[e.onpause||function(){}],t._onplay=[e.onplay||function(){}],t._onendTimer=[],t._webAudio=s&&!t._buffer,t._audioNode=[],t._webAudio&&t._setupAudioNode(),y._howls.push(t),t.load()}l.prototype={volume:function(e){var t=this;if(0<=(e=parseFloat(e))&&e<=1){for(var i in t._volume=e,s&&(o.gain.value=e),t._howls)if(t._howls.hasOwnProperty(i)&&!1===t._howls[i]._webAudio)for(var n=0;n<t._howls[i]._audioNode.length;n++)t._howls[i]._audioNode[n].volume=t._howls[i]._volume*t._volume;return t}return s?o.gain.value:t._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(e){var t,i=this;for(t in i._muted=e,s&&(o.gain.value=e?0:i._volume),i._howls)if(i._howls.hasOwnProperty(t)&&!1===i._howls[t]._webAudio)for(var n=0;n<i._howls[t]._audioNode.length;n++)i._howls[t]._audioNode[n].muted=e}};var c,d,a,m,y=new l,t=null;h||(c={mp3:!!(t=new Audio).canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});e.prototype={load:function(){var e=this,t=null;if(!h){for(var i,n,o,s,a=0;a<e._urls.length;a++){if(e._format)i=e._format;else{if(!(i=(i=(n=e._urls[a].toLowerCase().split("?")[0]).match(/.+\.([^?]+)(\?|$)/))&&2<=i.length?i:n.match(/data\:audio\/([^?]+);/)))return void e.on("loaderror");i=i[1]}if(c[i]){t=e._urls[a];break}}if(t)return e._src=t,e._webAudio?d(e,t):((o=new Audio).addEventListener("error",function(){o.error&&4===o.error.code&&(l.noAudio=!0),e.on("loaderror",{type:o.error?o.error.code:0})},!1),e._audioNode.push(o),o.src=t,o._pos=0,o.preload="auto",o.volume=y._muted?0:e._volume*y.volume(),r[t]=e,s=function(){e._duration=Math.ceil(10*o.duration)/10,0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e.on("load")),e._autoplay&&e.play(),o.removeEventListener("canplaythrough",s,!1)},o.addEventListener("canplaythrough",s,!1),o.load()),e}e.on("loaderror")},urls:function(e){var t=this;return e?(t.stop(),t._urls="string"==typeof e?[e]:e,t._loaded=!1,t.load(),t):t._urls},play:function(g,f){var p=this;return"function"==typeof g&&(f=g),g&&"function"!=typeof g||(g="_default"),p._loaded?p._sprite[g]?p._inactiveNode(function(e){e._sprite=g;var t,i,n,o,s,a=0<e._pos?e._pos:p._sprite[g][0]/1e3,r=p._sprite[g][1]/1e3-e._pos,h=!(!p._loop&&!p._sprite[g][2]),l="string"==typeof f?f:Math.round(Date.now()*Math.random())+"";if(t={id:l,sprite:g,loop:h},c=setTimeout(function(){!p._webAudio&&h&&p.stop(t.id).play(g,t.id),p._webAudio&&!h&&(p._nodeById(t.id).paused=!0,p._nodeById(t.id)._pos=0),p._webAudio||h||p.stop(t.id),p.on("end",l)},1e3*r),p._onendTimer.push({timer:c,id:t.id}),p._webAudio){var c=p._sprite[g][0]/1e3,d=p._sprite[g][1]/1e3;e.id=l,e.paused=!1,m(p,[h,c,d],l),p._playStart=w.currentTime,e.gain.value=p._volume,void 0===e.bufferSource.start?e.bufferSource.noteGrainOn(0,a,r):e.bufferSource.start(0,a,r)}else{if(4!==e.readyState&&(e.readyState||!navigator.isCocoonJS))return p._clearEndTimer(l),i=p,n=g,o=f,(s=e).addEventListener("canplaythrough",u,!1),p;e.readyState=4,e.id=l,e.currentTime=a,e.muted=y._muted||e.muted,e.volume=p._volume*y.volume(),setTimeout(function(){e.play()},0)}function u(){i.play(n,o),s.removeEventListener("canplaythrough",u,!1)}return p.on("play"),"function"==typeof f&&f(l),p}):"function"==typeof f&&f():p.on("load",function(){p.play(g,f)}),p},pause:function(e){var t=this;if(t._loaded){t._clearEndTimer(e);var i=e?t._nodeById(e):t._activeNode();if(i)if(i._pos=t.pos(null,e),t._webAudio){if(!i.bufferSource||i.paused)return t;i.paused=!0,void 0===i.bufferSource.stop?i.bufferSource.noteOff(0):i.bufferSource.stop(0)}else i.pause();t.on("pause")}else t.on("play",function(){t.pause(e)});return t},stop:function(e){var t=this;if(t._loaded){t._clearEndTimer(e);var i=e?t._nodeById(e):t._activeNode();if(i)if(i._pos=0,t._webAudio){if(!i.bufferSource||i.paused)return t;i.paused=!0,void 0===i.bufferSource.stop?i.bufferSource.noteOff(0):i.bufferSource.stop(0)}else isNaN(i.duration)||(i.pause(),i.currentTime=0)}else t.on("play",function(){t.stop(e)});return t},mute:function(e){var t,i=this;return i._loaded?(t=e?i._nodeById(e):i._activeNode())&&(i._webAudio?t.gain.value=0:t.muted=!0):i.on("play",function(){i.mute(e)}),i},unmute:function(e){var t,i=this;return i._loaded?(t=e?i._nodeById(e):i._activeNode())&&(i._webAudio?t.gain.value=i._volume:t.muted=!1):i.on("play",function(){i.unmute(e)}),i},volume:function(e,t){var i,n=this;return 0<=(e=parseFloat(e))&&e<=1?(n._volume=e,n._loaded?(i=t?n._nodeById(t):n._activeNode())&&(n._webAudio?i.gain.value=e:i.volume=e*y.volume()):n.on("play",function(){n.volume(e,t)}),n):n._volume},loop:function(e){return"boolean"==typeof e?(this._loop=e,this):this._loop},sprite:function(e){return"object"==typeof e?(this._sprite=e,this):this._sprite},pos:function(e,t){var i=this;if(!i._loaded)return i.on("load",function(){i.pos(e)}),"number"==typeof e?i:i._pos||0;e=parseFloat(e);var n=t?i._nodeById(t):i._activeNode();if(n)return 0<=e?(i.pause(t),n._pos=e,i.play(n._sprite,t),i):i._webAudio?n._pos+(w.currentTime-i._playStart):n.currentTime;if(0<=e)return i;for(var o=0;o<i._audioNode.length;o++)if(i._audioNode[o].paused&&4===i._audioNode[o].readyState)return i._webAudio?i._audioNode[o]._pos:i._audioNode[o].currentTime},pos3d:function(e,t,i,n){var o,s=this;if(t=void 0!==t&&t?t:0,i=void 0!==i&&i?i:-.5,s._loaded){if(!(0<=e||e<0))return s._pos3d;s._webAudio&&(o=n?s._nodeById(n):s._activeNode())&&(s._pos3d=[e,t,i],o.panner.setPosition(e,t,i),o.panner.panningModel=s._model||"HRTF")}else s.on("play",function(){s.pos3d(e,t,i,n)});return s},fade:function(e,n,t,o,s){var a=this,i=Math.abs(e-n),r=n<e?"down":"up",h=i/.01,l=t/h;if(!a._loaded)return a.on("load",function(){a.fade(e,n,t,o,s)}),a;a.volume(e,s);for(var c=1;c<=h;c++)!function(){var e=a._volume+("up"==r?.01:-.01)*c,t=Math.round(1e3*e)/1e3,i=n;setTimeout(function(){a.volume(t,s),t===i&&o&&o()},l*c)}()},fadeIn:function(e,t,i){return this.volume(0).play().fade(0,e,t,i)},fadeOut:function(e,t,i,n){var o=this;return o.fade(o._volume,e,t,function(){i&&i(),o.pause(n),o.on("end")},n)},_nodeById:function(e){for(var t=this._audioNode[0],i=0;i<this._audioNode.length;i++)if(this._audioNode[i].id===e){t=this._audioNode[i];break}return t},_activeNode:function(){for(var e=null,t=0;t<this._audioNode.length;t++)if(!this._audioNode[t].paused){e=this._audioNode[t];break}return this._drainPool(),e},_inactiveNode:function(e){for(var t,i=this,n=null,o=0;o<i._audioNode.length;o++)if(i._audioNode[o].paused&&4===i._audioNode[o].readyState){e(i._audioNode[o]),n=!0;break}i._drainPool(),n||(i._webAudio?(t=i._setupAudioNode(),e(t)):(i.load(),(t=i._audioNode[i._audioNode.length-1]).addEventListener(navigator.isCocoonJS?"canplaythrough":"loadedmetadata",function(){e(t)})))},_drainPool:function(){for(var e=this,t=0,i=0;i<e._audioNode.length;i++)e._audioNode[i].paused&&t++;for(i=e._audioNode.length-1;0<=i&&!(t<=5);i--)e._audioNode[i].paused&&(e._webAudio&&e._audioNode[i].disconnect(0),t--,e._audioNode.splice(i,1))},_clearEndTimer:function(e){for(var t=0,i=0;i<this._onendTimer.length;i++)if(this._onendTimer[i].id===e){t=i;break}var n=this._onendTimer[t];n&&(clearTimeout(n.timer),this._onendTimer.splice(t,1))},_setupAudioNode:function(){var e=this,t=e._audioNode,i=e._audioNode.length;return t[i]=void 0===w.createGain?w.createGainNode():w.createGain(),t[i].gain.value=e._volume,t[i].paused=!0,t[i]._pos=0,t[i].readyState=4,t[i].connect(o),t[i].panner=w.createPanner(),t[i].panner.panningModel=e._model||"equalpower",t[i].panner.setPosition(e._pos3d[0],e._pos3d[1],e._pos3d[2]),t[i].panner.connect(t[i]),t[i]},on:function(e,t){var i=this["_on"+e];if("function"==typeof t)i.push(t);else for(var n=0;n<i.length;n++)t?i[n].call(this,t):i[n].call(this);return this},off:function(e,t){for(var i=this["_on"+e],n=t.toString(),o=0;o<i.length;o++)if(n===i[o].toString()){i.splice(o,1);break}return this},unload:function(){for(var e=this,t=e._audioNode,i=0;i<e._audioNode.length;i++)t[i].paused||e.stop(t[i].id),e._webAudio?t[i].disconnect(0):t[i].src="";for(i=0;i<e._onendTimer.length;i++)clearTimeout(e._onendTimer[i].timer);var n=y._howls.indexOf(e);null!==n&&0<=n&&y._howls.splice(n,1),delete r[e._src]}},s&&(d=function(t,i){if(i in r)t._duration=r[i].duration,a(t);else{var n=new XMLHttpRequest;n.open("GET",i,!0),n.responseType="arraybuffer",n.onload=function(){w.decodeAudioData(n.response,function(e){e&&a(t,r[i]=e)},function(e){t.on("loaderror")})},n.onerror=function(){t._webAudio&&(t._buffer=!0,t._webAudio=!1,t._audioNode=[],delete t._gainNode,t.load())};try{n.send()}catch(e){n.onerror()}}},a=function(e,t){e._duration=t?t.duration:e._duration,0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e.on("load")),e._autoplay&&e.play()},m=function(e,t,i){i=e._nodeById(i);i.bufferSource=w.createBufferSource(),i.bufferSource.buffer=r[e._src],i.bufferSource.connect(i.panner),i.bufferSource.loop=t[0],t[0]&&(i.bufferSource.loopStart=t[1],i.bufferSource.loopEnd=t[1]+t[2]),i.bufferSource.playbackRate.value=e._rate}),"function"==typeof define&&define.amd&&define(function(){return{Howler:y,Howl:e}}),"undefined"!=typeof exports&&(exports.Howler=y,exports.Howl=e),"undefined"!=typeof window&&(window.Howler=y,window.Howl=e)}(),!function(t,e,i,n){t.GameMixAPIName=n,t[n]=t[n]||function(e){t[n].q=t[n].q||[],t[n].q.push(e)},t[n]({apiDomain:i});var o=e.createElement("script"),e=e.getElementsByTagName("script")[0];o.type="text/javascript",o.async=!0,o.src=i+"/v1/gm.js",e.parentNode.insertBefore(o,e)}(window,document,"//gmapi.gamemix.com","gmapi"),gmapi("donttap"),window.googletag=window.googletag||{},googletag.cmd=googletag.cmd||[],!function(){var e=document.createElement("script"),t=(e.async=!0,e.type="text/javascript","https:"==document.location.protocol),t=(e.src=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}(),Area.prototype={contains:function(e,t){return e>=this.x&&t>=this.y&&e<=this.x+this.width&&t<=this.y+this.height},actionPerformed:function(e,t){this.onactionperformed&&this.onactionperformed(e,t)},actionStart:function(e,t){this.onactionstart&&this.onactionstart(e,t)},actionCancel:function(e,t){this.onactioncancel&&this.onactioncancel(e,t)}},Screen.prototype={cycle:function(e){},touchStart:function(e,t){for(var i in this.areas)if(this.areas[i].enabled&&this.areas[i].contains(e,t)){this.currentActionArea=this.areas[i],this.currentActionArea.actionStart(e,t);break}},touchMove:function(e,t){this.currentActionArea&&!this.currentActionArea.contains(e,t)&&(this.currentActionArea.actionCancel(e,t),this.currentActionArea=null)},touchEnd:function(e,t){this.currentActionArea&&this.currentActionArea.contains(e,t)&&this.currentActionArea.actionPerformed(e,t),this.currentActionArea=null},create:function(){},destroy:function(){},addArea:function(e){this.areas.push(e)},areaContains:function(e,t){for(var i in this.areas)if(this.areas[i].enabled&&this.areas[i].contains(e,t))return!0;return!1},getId:function(){}},DisplayableObject.prototype={applyTransforms:function(e){0==this.x&&0==this.y||e.translate(this.x,this.y),1==this.scaleX&&1==this.scaleY||e.scale(this.scaleX,this.scaleY),0!=this.rotation&&e.rotate(this.rotation),1!=this.alpha&&(e.globalAlpha*=this.alpha)},doRender:function(e){this.visible&&.01<this.alpha&&0!=this.scaleX&&0!=this.scaleY&&(e.save(),this.applyTransforms(e),this.render(e),e.restore())},render:function(e){throw new Error("Rendering undefined")},remove:function(){this.parent&&this.parent.removeChild(this)},leaves:function(){return 1}},DisplayableContainer.prototype=extendPrototype(DisplayableObject,{render:function(e){for(var t=-1;this.children[++t];)this.children[t].doRender(e)},addChild:function(e){e.parent&&e.parent.removeChild(e),this.children.push(e),e.parent=this,e.parentIndex=this.children.length-1},removeChild:function(e){if(!isNaN(e.parentIndex)){this.children.splice(e.parentIndex,1);for(var t=e.parentIndex;t<this.children.length;t++)this.children[t].parentIndex--;e.parent=null,e.parentIndex=null}},clear:function(){for(var e in this.children)this.children[e].parent=null,this.children[e].parentIndex=null;this.children=[]},leaves:function(){var e,t=0;for(e in this.children)t+=this.children[e].leaves();return t}}),DisplayableRectangle.prototype=extendPrototype(DisplayableContainer,{render:function(e){e.fillStyle=this.color,e.fillRect(0,0,this.width,this.height),DisplayableContainer.prototype.render.call(this,e)}}),DisplayableShape.prototype=extendPrototype(DisplayableObject,{render:function(e){this.drawFunction(e)}}),DisplayableTextField.prototype=extendPrototype(DisplayableObject,{render:function(e){null!=this.text&&0<this.text.toString().length&&(e.font=this.font,e.textAlign=this.textAlign,e.textBaseline=this.textBaseline,this.shadowColor&&(e.fillStyle=this.shadowColor,e.fillText(this.text,this.shadowOffsetX,this.shadowOffsetY)),e.fillStyle=this.color,e.fillText(this.text,0,0))}}),DisplayableImage.prototype=extendPrototype(DisplayableObject,{render:function(e){e.drawImage(this.image,this.anchorX,this.anchorY)}}),Tween.prototype={cycle:function(e){0<this.delayLeft&&(this.delayLeft-=e,this.object[this.property]=this.from),this.delayLeft<=0&&(this.elapsed+=e,this.elapsed>=this.duration?this.finish():this.progress())},finish:function(){this.finished||(this.finished=!0,this.delayLeft=0,this.elapsed=this.duration,this.object[this.property]=this.to,this.onFinish&&this.onFinish.call(this))},isFinished:function(){return this.elapsed>=this.duration},progress:function(){var e=0<this.duration?this.elapsed/this.duration:1;this.object[this.property]=e*(this.to-this.from)+this.from}};var TweenPool={tweens:[],cycle:function(e){for(var t=0;this.tweens[t];)this.tweens[t].cycle(e),this.tweens[t].isFinished()?this.tweens.splice(t,1):t++},remove:function(e){e=this.tweens.indexOf(e);0<=e&&this.tweens.splice(e,1)},add:function(e){this.tweens.push(e)}};function Button(e,t){DisplayableObject.call(this),this.pressed=!1,this.action=t,this.width=e.width||300,this.height=e.height||80,this.bgColor=e.bgColor||"#ffffff",this.borderColor=e.lineColor||"#000",this.borderRadius=e.borderRadius||10,this.textColor=e.textColor||"#000",this.fontSize=e.fontSize||40,this.outlineColor=e.outlineColor||"#000",this.outlineWidth=e.outlineWidth||0,this.id=e.id||void 0,this.setContent(e.content)}Button.prototype=extendPrototype(DisplayableObject,{setContent:function(e){this.text=this.image=null,"string"==typeof e?(this.type="button",this.text=e,this.id=this.text):(this.type="image",this.image=e,this.width=e.width,this.height=e.height)},render:function(e){this.text?(e.save(),e.translate(.5,.5),e.globalAlpha*=this.pressed?.5:1,e.beginPath(),e.fillStyle=this.bgColor,e.strokeStyle=this.borderColor,e.lineWidth=2,e.moveTo(0,this.borderRadius),e.arc(this.borderRadius,this.borderRadius,this.borderRadius,Math.PI,-Math.PI/2,!1),e.arc(this.width-this.borderRadius,this.borderRadius,this.borderRadius,-Math.PI/2,0,!1),e.arc(this.width-this.borderRadius,this.height-this.borderRadius,this.borderRadius,0,Math.PI/2,!1),e.arc(this.borderRadius,this.height-this.borderRadius,this.borderRadius,Math.PI/2,Math.PI,!1),e.closePath(),e.fill(),e.stroke(),e.restore(),e.font=this.fontSize+"pt Bariol",e.textAlign="center",e.textBaseline="middle",e.fillStyle=this.textColor,e.fillText(this.text,this.width/2,this.height/2),0<this.outlineWidth&&(e.lineWidth=this.outlineWidth,e.strokeStyle=this.outlineColor,e.strokeText(this.text,this.width/2,this.height/2+3))):(e.globalAlpha*=this.pressed?.5:1,e.drawImage(this.image,0,0,this.image.width,this.image.height,0,0,this.width,this.height))},getArea:function(){var e=this;return new Area(this.x,this.y,this.width,this.height,{actionStart:function(){e.pressed=!0},actionPerformed:function(){e.pressed=!1,e.action(),Tracker.event("button-clicked","button-"+e.id)},actionCancel:function(){e.pressed=!1}})}});var P={width:640,height:960,gridWidth:4,gridHeight:4,leaderboardKey:"tap-lb",gameURL:"http://www.donttap.com/",facebookShareURL:"https://www.facebook.com/sharer/sharer.php?t=%text%&u=%url%",twitterShareURL:"https://twitter.com/intent/tweet?text=%text%",cocoon:!!window.isCocoon},AdsSettings={ads:{tablet:{slot:"/20973361/whiteblock_iPad_300x600",width:300,height:600,interval:6,check:function(){return 0<=navigator.userAgent.toLowerCase().indexOf("ipad")}},mobile:{slot:"/20973361/whiteblock_mobile_300x250",width:300,height:250,interval:4,check:function(){return Util.isTouchScreen()}},web:{slot:"/20973361/whiteblock_desktop_300x600",width:300,height:600,interval:5,check:function(){return!0}}}},resources=(window.addToHomeConfig={touchIcon:!0,autostart:!1},{folder:"img/",image:{menu_bg:"menu-bg.png",end_bg:"end-bg.png",character:"character.png",logo:"logo.png",button_fb:"fb.png",button_twitter:"twitter.png",button_fb_clean:"fb-clean.png",button_twitter_clean:"twitter-clean.png",gameover_bg:"gameover-bg.png",button_kik_white:"kik-white.png",button_kik_black:"kik-black.png",button_menu_white:"menu-white.png",button_menu_black:"menu-black.png",button_retry:"retry.png",bubble:"bubble.png",domain:"domain.png"}});function Game(){Game.instance=this,(window.G=this).curScreen=null;var e;if(this.frameCount=0,this.leaderboard=new LocalLeaderboard,this.leaderboard.load(),window.kik&&kik.message&&(Tracker.event("kik-message","kik-message-open"),kik.message.mode))switch(kik.message.mode){case"endurance":e=new EnduranceMode(this);break;case"pattern":e=new PatternMode(this);break;case"frenzy":e=new FrenzyMode(this)}e?this.newGame(e):this.menu(),cycleManager.init(this.cycle.bind(this)),DOM.on(document.body,"touchstart mousedown",this.handleDownEvent.bind(this)),DOM.on(document.body,"touchmove mousemove",this.handleMoveEvent.bind(this)),DOM.on(document.body,"touchend mouseup touchcancel",this.handleUpEvent.bind(this)),DOM.on("ad-close-button","click touchend",this.closeAd.bind(this)),DOM.on("ad-over","click touchend",this.closeAd.bind(this)),this.kikInit();var t,i,n=["a6","a7","a8","c6","c7","c8","c9","d6","d7","d8","f6","f7","f8","g6","g7","g8"];for(i in this.sounds=[],n)t=new Howl({urls:["sound/"+n[i]+".mp3","sound/"+n[i]+".ogg"],volume:1}),this.sounds.push(t);this.initAds()}DOM.on(window,"load",function(){DOM.un(window,"load",arguments.callee),(can=DOM.get("gamecanvas")).width=P.width,can.height=P.height,ctx=can.getContext("2d"),window.resizer=new Resizer({element:DOM.get("viewport"),delay:10,baseWidth:P.width,baseHeight:P.height,onResize:function(){window.scrollTo(0,1)}});function e(){var e=window.innerWidth,t=window.innerHeight;window.resizer.needsResize(e,t)}P.cocoon||(DOM.on(window,"resize orientationchange",e),e()),0<=document.location.search.indexOf("domconsole")&&(window.console=new DOMConsole),Tracker.stage("screen-loading"),new ResourceLoader(resources).load(function(e){R=e,Util.isTouchScreen()&&window.scrollTo(0,1),new Game(resizer)},can)}),Game.prototype={setScreen:function(e,t,i){var n;this.curScreen&&this.curScreen.destroy(),n=0<=location.search.indexOf("amazon")?"amazon":P.cocoon?Detect.isAndroid()?"nativeandroid":"nativeios":window.kik&&kik.send?"kik":"standalone"in window.navigator&&window.navigator.standalone?"homescreen":"nonkik",Tracker.stage("screen-"+e.getId()+"-"+n),this.curScreen=e,this.curScreen.create(),this.stage=this.curScreen.view},cycle:function(e){var t=Date.now(),e=(this.curScreen.cycle(e),TweenPool.cycle(e),ctx.fillStyle="#000",ctx.fillRect(0,0,P.width,P.height),Date.now()),i=(this.stage.doRender(ctx),Date.now());P.showFrameRate&&(ctx.textAlign="left",ctx.fillStyle="#ffffff",ctx.fillText("FPS: "+cycleManager.fps,10,10),ctx.fillText("Total: "+(i-t),10,20),ctx.fillText("Cycle: "+(e-t),10,30),ctx.fillText("Render: "+(i-e),10,40),ctx.fillText("Theoretical: "+Math.round(1e3/Math.max(1,i-t)),10,50),ctx.fillText("Size: "+this.stage.leaves(),10,60))},getPosition:function(e){e.touches&&(e=e.touches[e.touches.length-1]);var t=can.getBoundingClientRect();return res=P.cocoon?{x:e.clientX,y:e.clientY}:{x:(e.clientX-t.left)/(t.width/P.width),y:(e.clientY-t.top)/(t.height/P.height)}},handleDownEvent:function(e){var t=0<=e.type.indexOf("touch")?"touch":"mouse";this.inputType=this.inputType||t,t!=this.inputType||this.adOpen||(this.down=!0,this.lastEvent=this.getPosition(e),this.curScreen.touchStart(this.lastEvent.x,this.lastEvent.y))},handleMoveEvent:function(e){this.lastEvent=this.getPosition(e),this.down&&(e.preventDefault(),this.curScreen.touchMove(this.lastEvent.x,this.lastEvent.y)),this.curScreen.areaContains(this.lastEvent.x,this.lastEvent.y)?can.style.cursor="pointer":can.style.cursor="default","touch"==this.inputType&&e.preventDefault()},handleUpEvent:function(e){this.down&&(this.curScreen.touchEnd(this.lastEvent.x,this.lastEvent.y),this.down=!1,this.lastEvent=null),window.scrollTo(0,1)},newGame:function(e,t){this.lastMode=e,this.setScreen(new GameplayScreen(this,this.lastMode)),addToHome.close(),!Detect.isIOS()&&P.cocoon&&CocoonJS.Ad.hideBanner()},gameOver:function(){var t,i;Tracker.event("end-mode","end-mode-"+this.lastMode.getId()),this.setScreen(new EndScreen(this,this.lastMode)),window.gmga("gamedone"),this.gamesToNextAd--,this.gamesToNextAd<=0&&this.showAd(),addToHome.show(),this.lastMode.isSuccess()&&(t=this.lastMode.getLeaderboardId(),i=this.lastMode.getLeaderboardScore(),gmapi(function(e){e.game.leaderboard.sendScore(i,{levelName:t})})),!Detect.isIOS()&&P.cocoon&&this.showCocoonAd()},menu:function(){this.lastMode=null,this.setScreen(new MenuScreen(this))},retry:function(){this.newGame(this.lastMode,!0)},getSocialText:function(){return this.lastMode&&this.lastMode.isSuccess()?this.lastMode.getSocialText():"Play #DontTap on your phone, tablet, and desktop computer at "+P.gameURL+"! #WhiteTile"},open:function(e){P.cocoon?CocoonJS.App.openURL.apply(CocoonJS.App,arguments):window.open.apply(window,arguments)},shareKik:function(){Tracker.event("share","share-kik-"+(this.lastMode&&this.lastMode.isSuccess()?"score":"generic"));var e=this.getSocialText(),t={};this.lastMode&&this.lastMode.isSuccess()&&(t.mode=this.lastMode.getId(),t.score=this.lastMode.getScore()),kik.send({title:e,text:"Can you beat me?",pic:"promo/kik-icon.png",data:t})},shareFacebook:function(e){Tracker.event("share","share-facebook-"+(this.lastMode&&this.lastMode.isSuccess()?"score":"generic"));var t=P.facebookShareURL.replace("%text%",encodeURIComponent(this.getSocialText())).replace("%url%",encodeURIComponent(P.gameURL));this.open(t,"shareFbWindow","width=650,height=440,scrollbars=yes,location=no")},shareTwitter:function(e){Tracker.event("share","share-twitter-"+(this.lastMode&&this.lastMode.isSuccess()?"score":"generic"));var t=P.twitterShareURL.replace("%text%",encodeURIComponent(this.getSocialText()));this.open(t,"shareTwitterWindow","width=450,height=450,scrollbars=yes,location=no")},rate:function(){Util.isAndroid()?CocoonJS.App.openURL(P.googlePlayURL):CocoonJS.App.openURL(P.appStoreURL)},kikInit:function(){window.kik&&(kik.browser&&(kik.browser.setOrientationLock&&kik.browser.setOrientationLock("portrait"),kik.browser.statusBar&&kik.browser.statusBar(!1)),kik.metrics&&kik.metrics.enableGoogleAnalytics&&kik.metrics.enableGoogleAnalytics())},playSound:function(e){this.sounds[e].play()},initCocoonAds:function(){console.log("Initializing cocoon ads");CocoonJS.Ad.onFullScreenShown.addEventListener(function(){}),CocoonJS.Ad.onFullScreenHidden.addEventListener(function(){CocoonJS.Ad.refreshFullScreen()}),CocoonJS.Ad.onFullScreenReady.addEventListener(function(){}),CocoonJS.Ad.preloadFullScreen()},showCocoonAd:function(){return console.log("Show a cocoon ad"),CocoonJS.Ad.showFullScreen(),!0},initGoogleAds:function(){var e=this,t=(googletag.cmd.push(function(){e.adSlot=googletag.defineSlot(e.adSettings.slot,[e.adSettings.width,e.adSettings.height],"ad").addService(googletag.pubads()),googletag.pubads().enableSingleRequest(),googletag.enableServices(),googletag.display("ad"),e.adCreated=!0}),DOM.get("ad-container"));t.style.width=this.adSettings.width+"px",t.style.height=this.adSettings.height+"px"},getAdInterval:function(){return this.adSettings.interval},initAds:function(){if(!this.adsInitted){for(var e in this.adsInitted=!0,AdsSettings.ads)if(AdsSettings.ads[e].check()){this.adSettings=AdsSettings.ads[e];break}this.adSettings&&(P.cocoon?this.initCocoonAds():this.initGoogleAds(),this.gamesToNextAd=this.getAdInterval())}},closeAd:function(){var e;this.adOpen&&(P.cocoon?CocoonJS.Ad.hideBanner():(this.adOpen=!1,ga("send","event","ad","close","close-ad"),DOM.hide("ad-over"),e=this,googletag.cmd.push(function(){googletag.pubads().refresh([e.adSettings.slot])})))},showAd:function(){this.adsInitted&&(console.log("showing ad?"),(P.cocoon?this.showCocoonAd():(DOM.show("ad-over"),this.adOpen=!0))&&(ga("send","event","ad","show","show-ad"),this.gamesToNextAd=this.getAdInterval()))}};var Tracker={suffix:function(){return"standalone"in window.navigator&&navigator.standalone?"-homescreen":window.cordova||P.cocoon?"-native":window.kik&&kik.send?"-kik":P.amazon?"-amazon":"-web"},event:function(e,t,i){window.cordova&&window.gaPlugin?gaPlugin.trackEvent(function(){console.log("Sent event data")},function(e){console.log("Error while sending event data: "+e)},"gameevent",e+this.suffix(),t+this.suffix(),i||0):window.ga&&ga("send","event","gameevent",e+this.suffix(),t+this.suffix(),i||0)},stage:function(e){e="/stage-"+e+this.suffix();window.cordova&&window.gaPlugin?gaPlugin.trackPage(function(){console.log("Sent page view")},function(e){console.log("Error while sending page view: "+e)},e):window.ga&&ga("send","pageview",e)}};function LocalLeaderboard(){this.scores={}}function GameMode(){}function EnduranceMode(){GameMode.call(this)}function FrenzyMode(){GameMode.call(this)}function PatternMode(){GameMode.call(this)}function MenuScreen(e){Screen.call(this,e)}function GameplayScreen(e,t){Screen.call(this,e),this.mode=t}function EndScreen(e,t){Screen.call(this,e),this.mode=t}function Tile(e){DisplayableRectangle.call(this),this.color="#ffffff",this.highlightAlpha=0,this.highlightTween=null,this.onClick=e}function LeaderboardView(e){DisplayableContainer.call(this),this.scores=e,this.populate()}function SinView(){DisplayableShape.call(this,this.drawCurve.bind(this)),this.amplitude=0}function GaugeView(){DisplayableObject.call(this),this.width=100,this.height=3,this.value=0}LocalLeaderboard.prototype={load:function(){var e=Util.storage.getItem(P.leaderboardKey);this.scores=e?JSON.parse(e):{}},save:function(){Util.storage.setItem(P.leaderboardKey,JSON.stringify(this.scores))},getScores:function(e){return this.scores[e.getId()]||[]},addScore:function(e,t){var i;for(this.scores[e.getId()]||(this.scores[e.getId()]=[]),i=0;i<this.scores[e.getId()].length&&e.compareScores(t,this.scores[e.getId()][i].score)<0;)i++;this.scores[e.getId()].splice(i,0,{score:t,date:Date.now()}),this.save()},getHighscore:function(e){return this.scores[e.getId()]?this.scores[e.getId()][0]||null:0}},GameMode.prototype={initialize:function(e){this.screen=e},launch:function(){this.screen.showMessage("Tap the black tiles!")},tappedHighlighted:function(e){},tappedWrong:function(e){},cycle:function(e){},getScore:function(){return 0},getFormattedScore:function(e){return e.toString()},end:function(e){this.screen.over(e)},getId:function(){return null},getInstructions:function(){return null},getBgColor:function(){return"#000"},getGaugeValue:function(){return.5},getTimeValue:function(){return 0},isSuccess:function(){return!0},getScoreType:function(){return"points"},compareScores:function(e,t){return e-t},getLeaderboardId:function(){return null},getLeaderboardScore:function(){return 0}},EnduranceMode.prototype=extendPrototype(GameMode,{getId:function(){return"endurance"},getInstructions:function(){return["10 seconds for","every 40 taps"]},initialize:function(e){GameMode.prototype.initialize.call(this,e),this.score=0,this.timeLeft=0,this.gaugeValue=0,this.powerUpMode=!1},launch:function(){var e;GameMode.prototype.launch.call(this),this.refill();for(var t=0;t<3;t++){for(;e=~~(Math.random()*this.screen.tiles.length),this.screen.tiles[e].isHighlighted(););this.screen.tiles[e].highlight()}},refill:function(){this.timeLeft+=10,this.tilesToRefill=40,this.screen.showMessage("+10 seconds"),this.screen.showAddTime(10)},cycle:function(e){this.timeLeft-=e,this.timeLeft<=0?this.end("Time's up"):this.gaugeValue=Math.max(0,this.gaugeValue-.3*e)},getScore:function(){return this.score},tappedHighlighted:function(e){if(e.disable(),this.screen.showOk(e,"+1"),this.powerUpMode){for(var t=!0,i=0;i<this.screen.tiles.length;i++)if(this.screen.tiles[i].isHighlighted()){t=!1;break}if(t){this.powerUpMode=!1;for(i=0;i<3;i++){for(;n=~~(Math.random()*this.screen.tiles.length),this.screen.tiles[n].isHighlighted(););this.screen.tiles[n].highlight()}}}else{for(var n;(n=~~(Math.random()*this.screen.tiles.length))==this.screen.tiles.indexOf(e)||this.screen.tiles[n].isHighlighted(););this.screen.tiles[n].highlight(),this.gaugeValue=Math.min(1,this.gaugeValue+.08),1==this.gaugeValue&&this.powerUp()}this.tilesToRefill--,this.tilesToRefill<=0&&this.refill(),this.score++},powerUp:function(){this.powerUpMode=!0;for(var e=this.gaugeValue=0;e<this.screen.tiles.length;e++)!function(e){setTimeout(function(){e.highlight()},500*Math.random())}(this.screen.tiles[e]);this.screen.showMessage("Uber power up")},tappedWrong:function(e){this.screen.showError(e),this.end(["You tapped","a white tile!"])},getGaugeValue:function(){return this.gaugeValue},getTimeValue:function(){return this.timeLeft},getSocialText:function(){return"I scored "+this.score+" in Endurance playing Don't Tap! Can you beat me? Let's play: "+P.gameURL+" #donttap #whitetile"},getLeaderboardId:function(){return"endurance"},getLeaderboardScore:function(){return this.score}}),FrenzyMode.prototype=extendPrototype(GameMode,{getId:function(){return"frenzy"},getInstructions:function(){return["30 seconds,","nothing more"]},initialize:function(e){GameMode.prototype.initialize.call(this,e),this.score=0,this.timeLeft=30,this.gaugeValue=0},launch:function(){var e;GameMode.prototype.launch.call(this);for(var t=0;t<3;t++){for(;e=~~(Math.random()*this.screen.tiles.length),this.screen.tiles[e].isHighlighted(););this.screen.tiles[e].highlight()}},cycle:function(e){this.timeLeft-=e,this.timeLeft<=0?this.end("Time's up"):this.gaugeValue=Math.max(0,this.gaugeValue-.3*e)},getScore:function(){return this.score},tappedHighlighted:function(e){var t,i=Math.max(1,Math.ceil(5*this.gaugeValue));for(this.score+=i,e.disable(),this.screen.showOk(e,"+"+i);(t=~~(Math.random()*this.screen.tiles.length))==this.screen.tiles.indexOf(e)||this.screen.tiles[t].isHighlighted(););this.screen.tiles[t].highlight(),this.gaugeValue=Math.min(1,this.gaugeValue+.08)},tappedWrong:function(e){this.screen.showError(e),this.end(["You tapped","a white tile!"])},getBgColor:function(){return"#ffffff"},getGaugeValue:function(){return this.gaugeValue},getTimeValue:function(){return this.timeLeft},getSocialText:function(){return"I scored "+this.score+" in Frenzy playing Don't Tap! Can you beat me? Let's play: "+P.gameURL+" #donttap #whitetile"},getLeaderboardId:function(){return"frenzy"},getLeaderboardScore:function(){return this.score}}),PatternMode.prototype=extendPrototype(GameMode,{getId:function(){return"pattern"},getInstructions:function(){return["Clear all","the patterns"]},initialize:function(e){GameMode.prototype.initialize.call(this,e),this.score=0,this.time=0,this.gaugeValue=0,this.patternsToClear=15},nextPattern:function(){this.newPattern(this.patternSize())},patternSize:function(){return 4},newPattern:function(e){for(var t=0;t<e&&t<this.screen.tiles.length;t++){for(;ind=~~(Math.random()*this.screen.tiles.length),this.screen.tiles[ind].isHighlighted(););this.screen.tiles[ind].highlight()}},allWhite:function(){for(var e=0;e<this.screen.tiles.length;e++)if(this.screen.tiles[e].isHighlighted())return!1;return!0},launch:function(){GameMode.prototype.launch.call(this),this.nextPattern()},cycle:function(e){this.time+=e,this.gaugeValue=Math.max(0,this.gaugeValue-.3*e)},getTimeValue:function(){return this.time},tappedHighlighted:function(e){e.disable(),this.screen.showOk(e),this.allWhite()&&(this.patternsToClear--,0<this.patternsToClear?this.nextPattern():this.end("All clear")),this.score++,this.gaugeValue=Math.min(1,this.gaugeValue+.08)},tappedWrong:function(e){this.screen.showError(e),this.end(["You tapped","a white tile!"])},getBgColor:function(){return"#333333"},getGaugeValue:function(){return this.gaugeValue},isSuccess:function(){return 0==this.patternsToClear},getScore:function(){return this.time},getScoreType:function(){return"time"},getFormattedScore:function(e){return Math.round(100*e)/100},compareScores:function(e,t){return t-e},getSocialText:function(){return"I cleared all the tiles in "+this.getFormattedScore(this.time)+"s in Patterns playing Don't Tap! Can you beat me? Let's play: "+P.gameURL+" #donttap #whitetile"},getLeaderboardId:function(){return"pattern"},getLeaderboardScore:function(){return 1e3*this.time}}),MenuScreen.prototype=extendPrototype(Screen,{create:function(){this.view=new DisplayableContainer,this.bg=new DisplayableImage,this.bg.image=R.image.menu_bg,this.view.addChild(this.bg);var character=new DisplayableImage,logo=(character.image=R.image.character,character.x=300,character.y=500,this.view.addChild(character),new DisplayableImage),domain=(logo.image=R.image.logo,logo.x=100,logo.y=100,this.view.addChild(logo),new DisplayableImage),me=(domain.image=R.image.domain,domain.x=(P.width-domain.image.width)/2,domain.y=P.height-50,this.view.addChild(domain),this),versionArea=(this.enduranceButton=new Button({content:"Endurance",bgColor:"#000",textColor:"#ffffff",width:270,height:92},function(){me.game.newGame(new EnduranceMode)}),this.enduranceButton.x=64,this.enduranceButton.y=514,this.view.addChild(this.enduranceButton),this.addArea(this.enduranceButton.getArea()),this.frenzyButton=new Button({content:"Frenzy",width:270,height:92},function(){me.game.newGame(new FrenzyMode)}),this.frenzyButton.x=64,this.frenzyButton.y=726,this.view.addChild(this.frenzyButton),this.addArea(this.frenzyButton.getArea()),this.patternButton=new Button({content:"Pattern",bgColor:"#333333",textColor:"#ffffff",width:270,height:92},function(){me.game.newGame(new PatternMode)}),this.patternButton.x=64,this.patternButton.y=620,this.view.addChild(this.patternButton),this.addArea(this.patternButton.getArea()),this.fbButton=new Button({content:R.image.button_fb,id:"facebook-menu"},function(){me.game.shareFacebook()}),this.fbButton.x=104,this.fbButton.y=832,this.view.addChild(this.fbButton),this.addArea(this.fbButton.getArea()),this.twitterButton=new Button({content:R.image.button_twitter,id:"twitter-menu"},function(){me.game.shareTwitter()}),this.twitterButton.x=212,this.twitterButton.y=832,this.view.addChild(this.twitterButton),this.addArea(this.twitterButton.getArea()),P.cocoon&&(this.rateButton=new Button({content:"Rate!",bgColor:"#000",textColor:"#ffffff",width:90,height:30,fontSize:18},function(){me.game.rate()}),this.rateButton.x=55,this.rateButton.y=363),TweenPool.add(new Tween(character,"x",P.width,character.x,.3,.5)),TweenPool.add(new Tween(logo,"alpha",0,1,.5,1.5)),TweenPool.add(new Tween(this.enduranceButton,"alpha",0,1,.3,2)),TweenPool.add(new Tween(this.patternButton,"alpha",0,1,.3,2.3)),TweenPool.add(new Tween(this.frenzyButton,"alpha",0,1,.3,2.6)),P.cocoon&&TweenPool.add(new Tween(this.rateButton,"alpha",0,1,.3,2.9)),TweenPool.add(new Tween(this.twitterButton,"alpha",0,1,.3,2.9)),TweenPool.add(new Tween(this.fbButton,"alpha",0,1,.3,2.9)),new Area(200,340,200,100,{actionPerformed:function(){version.visible=!0}})),version=(this.addArea(versionArea),new DisplayableTextField);with(this.view.addChild(version),version)text=window.gameVersion,x=P.width-5,y=P.height-5,textAlign="right",textBaseline="bottom",color="black",font="20pt Arial",visible=!1},destroy:function(){},getId:function(){return"menu"}}),GameplayScreen.prototype=extendPrototype(Screen,{create:function(){this.view=new DisplayableContainer,this.background=new DisplayableRectangle,this.background.color=this.mode.getBgColor(),this.background.width=P.width,this.background.height=P.height,this.view.addChild(this.background),this.tilesContainer=new DisplayableRectangle,this.tilesContainer.width=P.width*(window.kik&&kik.send?.8:1),this.tilesContainer.height=this.tilesContainer.width,this.tilesContainer.x=(P.width-this.tilesContainer.width)/2,this.tilesContainer.y=(P.height-this.tilesContainer.height)/2,this.view.addChild(this.tilesContainer),this.tiles=[],this.tileMatrix=[];for(var t,tWidth=~~(this.tilesContainer.width/P.gridWidth),tHeight=~~(this.tilesContainer.height/P.gridHeight),me=this,i=0;i<P.gridWidth;i++){this.tileMatrix.push([]);for(var j=0;j<P.gridHeight;j++)t=new Tile(function(){me.tilePressed(this)}),t.x=this.tilesContainer.x+i*tWidth,t.y=this.tilesContainer.y+j*tHeight,t.width=tWidth,t.height=tHeight,this.view.addChild(t),this.addArea(t.getArea()),this.tiles.push(t),this.tileMatrix[i].push(t)}var labelY=32,labelSize=16,valueY=80,valueSize=52,scoreValueSize=72,scoreValueY=90;with(this.scoreLabel=new DisplayableTextField,this.scoreLabel.visible="points"==this.mode.getScoreType(),this.view.addChild(this.scoreLabel),this.scoreLabel)textAlign="center",textBaseline="middle",x=P.width/2,y=labelY,color="#bababa",font=labelSize+"pt Bariol",text="SCORE";with(this.scoreTf=new DisplayableTextField,this.scoreTf.visible="points"==this.mode.getScoreType(),this.view.addChild(this.scoreTf),this.scoreTf)textAlign="center",textBaseline="middle",x=P.width/2,y=scoreValueY,color="#ff0000",font=scoreValueSize+"pt Bariol",color="#1ba7c0";with(this.timeLabel=new DisplayableTextField,this.view.addChild(this.timeLabel),this.timeLabel)textAlign="center",textBaseline="middle",x=P.width-100,y=labelY,color="#bababa",font=labelSize+"pt Bariol",text="TIME";with(this.timeTf=new DisplayableTextField,this.view.addChild(this.timeTf),this.timeTf)textAlign="center",textBaseline="middle",x=P.width-100,y=valueY,color="#f1ac37",font=valueSize+"pt Bariol";with(this.highscoreLabel=new DisplayableTextField,this.view.addChild(this.highscoreLabel),this.highscoreLabel)textAlign="center",textBaseline="middle",x=100,y=labelY,color="#bababa",font=labelSize+"pt Bariol",text="HI-SCORE";with(this.highscoreTf=new DisplayableTextField,this.view.addChild(this.highscoreTf),this.highscoreTf){textAlign="center",textBaseline="middle",x=100,y=valueY,color="#bababa",font=valueSize+"pt Bariol";var hs=this.game.leaderboard.getHighscore(this.mode);text=hs?this.mode.getFormattedScore(hs.score):0}switch(this.mode.getScoreType()){case"points":this.highscoreTf.x=this.highscoreLabel.x=100,this.timeLabel.x=this.timeTf.x=P.width-100,this.scoreLabel.x=this.scoreTf.x=P.width/2;break;case"time":this.timeLabel.x=this.timeTf.x=2*P.width/3,this.highscoreLabel.x=this.highscoreTf.x=P.width/3}with(this.gauge=new GaugeView,this.gauge.width=~~(.75*P.width),this.gauge.height=16,this.gauge.x=(P.width-this.gauge.width)/2,this.gauge.y=P.height-60,this.view.addChild(this.gauge),this.message=new DisplayableTextField,this.view.addChild(this.message),this.message)color="#ffa500",font="52pt Bariol",textAlign="center",textBaseline="middle",x=P.width/2,y=P.height/2-40,visible=!1;var countDown=new DisplayableRectangle,instructions=(countDown.width=P.width,countDown.height=P.height,countDown.color="rgba(0,0,0,0.9)",this.view.addChild(countDown),new DisplayableTextField);with(instructions)x=P.width/2,y=P.height/2+120,color="#00abcd",textBaseline="middle",textAlign="center",font="20pt Bariol",text=this.mode.getInstructions();var messageQueue=[this.mode.getInstructions()].concat(3,2,1),countDownTfContainer=new DisplayableContainer,me=(countDownTfContainer.x=P.width/2,countDownTfContainer.y=P.height/2,this.view.addChild(countDownTfContainer),this),count=3,down=function(){if(0<messageQueue.length){var msg=messageQueue.shift();msg instanceof Array||(msg=[msg]),countDownTfContainer.clear();for(var tf,lineSize=96,i=0;i<msg.length;i++)with(tf=new DisplayableTextField,countDownTfContainer.addChild(tf),tf)textAlign="center",textBaseline="middle",font=(msg[i].toString().length<5?160:60)+"pt Bariol",color="#00abcd",text=msg[i].toString(),y=lineSize/2+(i-msg.length/2)*lineSize;setTimeout(arguments.callee,1e3),TweenPool.add(new Tween(countDownTfContainer,"scaleX",1,0,.2,.8)),TweenPool.add(new Tween(countDownTfContainer,"scaleY",1,0,.2,.8)),TweenPool.add(new Tween(countDownTfContainer,"alpha",1,0,.2,.8))}else TweenPool.add(new Tween(countDown,"alpha",1,0,.2,0,function(){this.object.remove()})),me.launch()};down(),this.mode.initialize(this),this.shakeTime=0,window.crossPromo&&window.crossPromo.hide()},destroy:function(){window.crossPromo&&window.crossPromo.show()},launch:function(){this.launched=!0,this.mode.launch(),this.showMessage("Tap the black tiles!")},tilePressed:function(e){!this.isOver&&this.launched&&(e.isHighlighted()?this.mode.tappedHighlighted(e):this.mode.tappedWrong(e))},updateGauge:function(){this.gauge.value=this.mode.getGaugeValue()},updateDisplayedScore:function(){this.previouslyDisplayedScore=this.previouslyDisplayedScore||0;var e=this.mode.getScore();this.scoreTf.text=e.toString(),e>this.previouslyDisplayedScore&&this.animateScore(),this.previouslyDisplayedScore=e},updateDisplayedTime:function(){var e=this.mode.getTimeValue();isNaN(e)?this.timeTf.text=null:(this.timeTf.text=Util.addZeros(Math.ceil(e),2),this.timeTf.color=!(5<e)&&0==~~(2*e%2)?"#ff0000":"#f1ac37")},animateScore:function(){this.timeScoreAnimated=.3,TweenPool.add(new Tween(this.scoreTf,"scaleX",2,1,.3)),TweenPool.add(new Tween(this.scoreTf,"scaleY",2,1,.3))},cycle:function(e){!this.isOver&&this.launched&&(this.mode.cycle(e),this.updateDisplayedScore(),this.updateDisplayedTime(),this.updateGauge()),this.timeScoreAnimated-=e,this.scoreTf.color=0<this.timeScoreAnimated?"#00ff00":"#1ba7c0",this.view.x=0,this.view.y=0,this.shakeTime-=e,0<this.shakeTime&&(this.view.x=~~Util.rand(-10,10),this.view.y=~~Util.rand(-10,10))},showMessage:function(e){this.message.visible=!0,this.message.text=e,TweenPool.add(new Tween(this.message,"scaleX",0,1,.2)),TweenPool.add(new Tween(this.message,"scaleY",0,1,.2)),clearTimeout(this.toClearMessage),this.toClearMessage=setTimeout(this.hideMessage.bind(this),2e3)},showBubbleMessage:function(a){a=a instanceof Array?a:[a],this.hideMessage();var container=new DisplayableContainer,bubble=(container.x=P.width/2,container.y=P.height/2,this.view.addChild(container),new DisplayableImage);bubble.image=R.image.bubble,bubble.anchorX=-bubble.image.width/2,bubble.anchorY=-bubble.image.height/2,container.addChild(bubble),TweenPool.add(new Tween(container,"scaleX",0,1,.2)),TweenPool.add(new Tween(container,"scaleY",0,1,.2));for(var tf,lineSize=48,i=0;i<a.length;i++)with(tf=new DisplayableTextField,container.addChild(tf),tf)textAlign="center",textBaseline="middle",font="40pt Bariol",color="#ffffff",text=a[i],y=lineSize/2+(i-a.length/2)*lineSize},hideMessage:function(){this.message.visible=!1},over:function(e){this.isOver=!0,this.showBubbleMessage(e),setTimeout(this.game.gameOver.bind(this.game),1e3),this.mode.isSuccess()&&this.game.leaderboard.addScore(this.mode,this.mode.getScore())},shake:function(){this.shakeTime=.5,P.cocoon||navigator.vibrate(500)},showError:function(e){var t=new DisplayableRectangle;t.color="#ff0000",t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,e.parent.addChild(t),TweenPool.add(new Tween(t,"alpha",1,0,.2)),this.shake()},showOk:function(tile,msg,msgColor){var indic=new DisplayableRectangle;if(indic.color="#00ff00",indic.x=tile.x,indic.y=tile.y,indic.width=tile.width,indic.height=tile.height,tile.parent.addChild(indic),TweenPool.add(new Tween(indic,"alpha",1,0,.2)),this.lastTap=Date.now(),msg){var tf=new DisplayableTextField;with(tile.parent.addChild(tf),tf)textAlign="center",textBaseline="middle",x=tile.x+tile.width/2,y=tile.y+tile.height/2,color=msgColor||"red",text=msg,font="40pt Bariol";TweenPool.add(new Tween(tf,"alpha",1,0,.2))}this.game.playSound(this.tiles.indexOf(tile))},showAddTime:function(t){var tf=new DisplayableTextField;with(this.view.addChild(tf),tf)text="+"+t,color=this.timeTf.color,font=this.timeTf.font,textAlign="center",textBaseline="middle",x=this.timeTf.x,y=this.timeTf.y+100;TweenPool.add(new Tween(tf,"y",tf.y,this.timeTf.y,.2,0,function(){this.object.remove()}))},getId:function(){return"gameplay-"+this.mode.getId()}}),EndScreen.prototype=extendPrototype(Screen,{create:function(){this.view=new DisplayableContainer,this.backgroundColor=new DisplayableRectangle,this.backgroundColor.width=P.width,this.backgroundColor.height=P.height,this.backgroundColor.color=this.mode.getBgColor(),this.view.addChild(this.backgroundColor),this.background=new DisplayableImage,this.background.image=R.image.gameover_bg,this.background.alpha=0,this.view.addChild(this.background);var char=new DisplayableImage,textColor=(char.image=R.image.end_bg,char.x=P.width-char.image.width-100,char.y=P.height-char.image.height-100,this.view.addChild(char),"#ffffff"==this.mode.getBgColor()?"#000":"#ffffff"),valueColor1="#178fff",valueColor2="#178fff",youScored=new DisplayableTextField;with(this.view.addChild(youScored),youScored)x=384,y=194,textAlign="right",textBaseline="middle",color=textColor,font="56pt Bariol",text="You scored ";var score=new DisplayableTextField;with(this.view.addChild(score),score)x=384,y=194,textAlign="left",textBaseline="middle",color=valueColor1,font="68pt Bariol",text=this.mode.getScore().toString();this.mode.isSuccess()?(youScored.text="You scored ",score.text=this.mode.getFormattedScore(this.mode.getScore())):(youScored.text="You failed",youScored.textAlign="center",youScored.x=P.width/2,score.text="");var dateLabel=new DisplayableTextField;with(this.view.addChild(dateLabel),dateLabel)x=P.width/3,y=280,textAlign="center",textBaseline="middle",color=textColor,font="28pt Bariol",text="DATE";var scoreLabel=new DisplayableTextField;with(this.view.addChild(scoreLabel),scoreLabel)x=2*P.width/3,y=280,textAlign="center",textBaseline="middle",color=textColor,font="28pt Bariol",text="SCORE";for(var scores=this.game.leaderboard.getScores(this.mode),date,score,nextY=dateLabel.y+50,i=0,d;i<8;i++){with(date=new DisplayableTextField,this.view.addChild(date),date)x=P.width/3,y=nextY,textAlign="center",textBaseline="middle",font="36pt Bariol";with(score=new DisplayableTextField,this.view.addChild(score),score)x=2*P.width/3,y=nextY,textAlign="center",textBaseline="middle",font="36pt Bariol";score.color=date.color=i%2==0?valueColor1:valueColor2,scores[i]?(score.text=this.mode.getFormattedScore(scores[i].score),d=new Date(scores[i].date),date.text=d.getMonth()+1+"/"+d.getDate()+"/"+d.getFullYear()):score.text=date.text="--",nextY+=50}var sc=this,buttons=[],button_suffix="#ffffff"==this.mode.getBgColor()?"_black":"_white";buttons.push(new Button({content:R.image.button_retry,id:"retry-end"},function(){sc.game.retry()})),buttons.push(new Button({content:R.image["button_menu"+button_suffix],id:"menu-end"},function(){sc.game.menu()})),window.kik&&kik.send&&buttons.push(new Button({content:R.image["button_kik"+button_suffix],id:"kik-end"},function(){sc.game.shareKik()}));for(var i=0;i<buttons.length;i++)buttons[i].x=P.width/2+40+(i-buttons.length/2)*(buttons[i].width+80),buttons[i].y=800-buttons[i].height/2,this.view.addChild(buttons[i]),this.addArea(buttons[i].getArea());this.fbButton=new Button({content:R.image.button_fb_clean,id:"facebook-end"},function(){sc.game.shareFacebook()}),this.fbButton.x=P.width-this.fbButton.width-40,this.fbButton.y=40,this.view.addChild(this.fbButton),this.addArea(this.fbButton.getArea()),this.twitterButton=new Button({content:R.image.button_twitter_clean,id:"twitter-end"},function(){sc.game.shareTwitter()}),this.twitterButton.x=this.fbButton.x-this.twitterButton.width-40,this.twitterButton.y=40,this.view.addChild(this.twitterButton),this.addArea(this.twitterButton.getArea())},destroy:function(){},getId:function(){return"end"}}),Tile.prototype=extendPrototype(DisplayableRectangle,{getArea:function(){return new Area(this.x,this.y,this.width,this.height,{actionStart:this.actionStart.bind(this),actionCancel:this.actionCancel.bind(this)})},actionStart:function(){this.onClick.call(this)},actionCancel:function(){},highlight:function(){this.highlighted=!0,this.highlightAlpha=1,this.highlightTween&&this.highlightTween.finish(),this.highlightTween=new Tween(this,"highlightAlpha",0,1,.2),TweenPool.add(this.highlightTween)},disable:function(){this.highlighted=!1,this.highlightTween&&this.highlightTween.finish(),this.highlightAlpha=0},isHighlighted:function(){return this.highlighted},render:function(e){DisplayableRectangle.prototype.render.call(this,e),e.globalAlpha=this.highlightAlpha,e.fillStyle="#000",e.fillRect(0,0,this.width,this.height),e.globalAlpha=1,e.strokeStyle="#b8b8b8",e.strokeRect(.5,.5,this.width-1,this.height-1)}}),LeaderboardView.prototype=extendPrototype(DisplayableContainer,{populate:function(){for(var dateTf,scoreTf,nextY=0,i=0;i<5;i++){with(dateTf=new DisplayableTextField,this.addChild(dateTf),dateTf)color="#ffffff",textAlign="right",x=P.width/2-5,y=nextY,font="10pt Arial",textBaseline="top",text="1/1/1";nextY+=20}}}),SinView.prototype=extendPrototype(DisplayableShape,{drawCurve:function(e){var t;e.strokeStyle="#ffffff",e.beginPath(),e.moveTo(0,0);for(var i=0;i<P.width;i++)t=(1-Math.abs(i-P.width/2)/(P.width/2))*this.amplitude,e.lineTo(i,Math.sin(Date.now()/50+i*Math.PI/5)*t*20);e.stroke()}}),GaugeView.prototype=extendPrototype(DisplayableObject,{render:function(e){e.fillStyle="#1076a8",e.fillRect(0,0,this.width,this.height),e.fillStyle="#33e4fb",e.fillRect(1,1,(this.width-2)*this.value,this.height-2)}});var addToHome=function(o){var s,n,a,r,h,l,c,d,u,g,f,p,w=o.navigator,t="platform"in w&&/iphone|ipod|ipad/gi.test(w.platform),m=0,y=0,e=0,b={autostart:!0,returningVisitor:!1,animationIn:"drop",animationOut:"fade",startDelay:2e3,lifespan:15e3,bottomOffset:14,expire:0,message:"",touchIcon:!1,arrow:!0,hookOnLoad:!0,closeButton:!0,iterations:100},v={ar:'<span dir="rtl">قم بتثبيت هذا التطبيق على <span dir="ltr">%device:</span>انقر<span dir="ltr">%icon</span> ،<strong>ثم اضفه الى الشاشة الرئيسية.</strong></span>',ca_es:"Per instal·lar aquesta aplicació al vostre %device premeu %icon i llavors <strong>Afegir a pantalla d'inici</strong>.",cs_cz:"Pro instalaci aplikace na Váš %device, stiskněte %icon a v nabídce <strong>Přidat na plochu</strong>.",da_dk:"Tilføj denne side til din %device: tryk på %icon og derefter <strong>Føj til hjemmeskærm</strong>.",de_de:"Installieren Sie diese App auf Ihrem %device: %icon antippen und dann <strong>Zum Home-Bildschirm</strong>.",el_gr:"Εγκαταστήσετε αυτήν την Εφαρμογή στήν συσκευή σας %device: %icon μετά πατάτε <strong>Προσθήκη σε Αφετηρία</strong>.",en_us:"Install this web app on your %device: tap %icon and then <strong>Add to Home Screen</strong>.",es_es:"Para instalar esta app en su %device, pulse %icon y seleccione <strong>Añadir a pantalla de inicio</strong>.",fi_fi:"Asenna tämä web-sovellus laitteeseesi %device: paina %icon ja sen jälkeen valitse <strong>Lisää Koti-valikkoon</strong>.",fr_fr:"Ajoutez cette application sur votre %device en cliquant sur %icon, puis <strong>Ajouter à l'écran d'accueil</strong>.",he_il:'<span dir="rtl">התקן אפליקציה זו על ה-%device שלך: הקש %icon ואז <strong>הוסף למסך הבית</strong>.</span>',hr_hr:"Instaliraj ovu aplikaciju na svoj %device: klikni na %icon i odaberi <strong>Dodaj u početni zaslon</strong>.",hu_hu:"Telepítse ezt a web-alkalmazást az Ön %device-jára: nyomjon a %icon-ra majd a <strong>Főképernyőhöz adás</strong> gombra.",it_it:"Installa questa applicazione sul tuo %device: premi su %icon e poi <strong>Aggiungi a Home</strong>.",ja_jp:"このウェブアプリをあなたの%deviceにインストールするには%iconをタップして<strong>ホーム画面に追加</strong>を選んでください。",ko_kr:'%device에 웹앱을 설치하려면 %icon을 터치 후 "홈화면에 추가"를 선택하세요',nb_no:"Installer denne appen på din %device: trykk på %icon og deretter <strong>Legg til på Hjem-skjerm</strong>",nl_nl:"Installeer deze webapp op uw %device: tik %icon en dan <strong>Voeg toe aan beginscherm</strong>.",pl_pl:"Aby zainstalować tę aplikacje na %device: naciśnij %icon a następnie <strong>Dodaj jako ikonę</strong>.",pt_br:"Instale este aplicativo em seu %device: aperte %icon e selecione <strong>Adicionar à Tela Inicio</strong>.",pt_pt:"Para instalar esta aplicação no seu %device, prima o %icon e depois em <strong>Adicionar ao ecrã principal</strong>.",ru_ru:"Установите это веб-приложение на ваш %device: нажмите %icon, затем <strong>Добавить в «Домой»</strong>.",sv_se:"Lägg till denna webbapplikation på din %device: tryck på %icon och därefter <strong>Lägg till på hemskärmen</strong>.",th_th:"ติดตั้งเว็บแอพฯ นี้บน %device ของคุณ: แตะ %icon และ <strong>เพิ่มที่หน้าจอโฮม</strong>",tr_tr:"Bu uygulamayı %device'a eklemek için %icon simgesine sonrasında <strong>Ana Ekrana Ekle</strong> düğmesine basın.",uk_ua:"Встановіть цей веб сайт на Ваш %device: натисніть %icon, а потім <strong>На початковий екран</strong>.",zh_cn:"您可以将此应用安装到您的 %device 上。请按 %icon 然后选择<strong>添加至主屏幕</strong>。",zh_tw:"您可以將此應用程式安裝到您的 %device 上。請按 %icon 然後點選<strong>加入主畫面螢幕</strong>。"};function x(){var e,t,i;o.removeEventListener("load",x,!1),d?b.expire&&l&&o.localStorage.setItem("addToHome",Date.now()+6e4*b.expire):o.localStorage.setItem("addToHome",Date.now()),(g||a&&l&&!c&&!r&&d)&&(e="",t=w.platform.split(" ")[0],i=w.language.replace("-","_"),(u=document.createElement("div")).id="addToHomeScreen",u.style.cssText+="left:-9999px;-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0;-webkit-transform:translate3d(0,0,0);position:"+(h<5?"absolute":"fixed"),b.message in v&&(i=b.message,b.message=""),""===b.message&&(b.message=i in v?v[i]:v.en_us),b.touchIcon&&(e=(e=n?document.querySelector('head link[rel^=apple-touch-icon][sizes="114x114"],head link[rel^=apple-touch-icon][sizes="144x144"],head link[rel^=apple-touch-icon]'):document.querySelector('head link[rel^=apple-touch-icon][sizes="57x57"],head link[rel^=apple-touch-icon]'))&&'<span style="background-image:url('+e.href+')" class="addToHomeTouchIcon"></span>'),u.className=(7<=h?"addToHomeIOS7 ":"")+(s?"addToHomeIpad":"addToHomeIphone")+(e?" addToHomeWide":""),u.innerHTML=e+b.message.replace("%device",t).replace("%icon",4.2<=h?'<span class="addToHomeShare"></span>':'<span class="addToHomePlus">+</span>')+(b.arrow?'<span class="addToHomeArrow"'+(7<=h&&s&&e?' style="margin-left:-32px"':"")+"></span>":"")+(b.closeButton?'<span class="addToHomeClose">×</span>':""),document.body.appendChild(u),b.closeButton&&(u.addEventListener("click",_,!1),u.querySelector(".addToHomeClose").addEventListener("touchstart",S,!1)),!s&&6<=h&&window.addEventListener("orientationchange",C,!1),setTimeout(T,b.startDelay))}function T(){var e,t=208;if(s)switch(h<5?(y=o.scrollY,m=o.scrollX):h<6?t=160:7<=h&&(t=143),u.style.top=y+b.bottomOffset+"px",u.style.left=Math.max(m+t-Math.round(u.offsetWidth/2),9)+"px",b.animationIn){case"drop":e="0.6s",u.style.webkitTransform="translate3d(0,"+-(o.scrollY+b.bottomOffset+u.offsetHeight)+"px,0)";break;case"bubble":e="0.6s",u.style.opacity="0",u.style.webkitTransform="translate3d(0,"+(y+50)+"px,0)";break;default:e="1s",u.style.opacity="0"}else switch(y=o.innerHeight+o.scrollY,h<5?(m=Math.round((o.innerWidth-u.offsetWidth)/2)+o.scrollX,u.style.left=m+"px",u.style.top=y-u.offsetHeight-b.bottomOffset+"px"):(u.style.left="50%",u.style.marginLeft=-Math.round(u.offsetWidth/2)-(o.orientation%180&&6<=h&&h<7?40:0)+"px",u.style.bottom=b.bottomOffset+"px"),b.animationIn){case"drop":e="1s",u.style.webkitTransform="translate3d(0,"+-(y+b.bottomOffset)+"px,0)";break;case"bubble":e="0.6s",u.style.webkitTransform="translate3d(0,"+(u.offsetHeight+b.bottomOffset+50)+"px,0)";break;default:e="1s",u.style.opacity="0"}u.offsetHeight,u.style.webkitTransitionDuration=e,u.style.opacity="1",u.style.webkitTransform="translate3d(0,0,0)",u.addEventListener("webkitTransitionEnd",k,!1),p=setTimeout(S,b.lifespan)}function S(){if(clearInterval(f),clearTimeout(p),p=null,u){var e=0,t=0,i="1",n="0";switch(b.closeButton&&u.removeEventListener("click",_,!1),!s&&6<=h&&window.removeEventListener("orientationchange",C,!1),h<5&&(e=s?o.scrollY-y:o.scrollY+o.innerHeight-y,t=s?o.scrollX-m:o.scrollX+Math.round((o.innerWidth-u.offsetWidth)/2)-m),u.style.webkitTransitionProperty="-webkit-transform,opacity",b.animationOut){case"drop":s?(n="0.4s",i="0",e+=50):(n="0.6s",e+=u.offsetHeight+b.bottomOffset+50);break;case"bubble":s?(n="0.8s",e-=u.offsetHeight+b.bottomOffset+50):(n="0.4s",i="0",e-=50);break;default:n="0.8s",i="0"}u.addEventListener("webkitTransitionEnd",k,!1),u.style.opacity=i,u.style.webkitTransitionDuration=n,u.style.webkitTransform="translate3d("+t+"px,"+e+"px,0)"}}function _(){o.sessionStorage.setItem("addToHomeSession","1"),c=!0,S()}function k(){u.removeEventListener("webkitTransitionEnd",k,!1),u.style.webkitTransitionProperty="-webkit-transform",u.style.webkitTransitionDuration="0.2s",p?h<5&&p&&(f=setInterval(i,b.iterations)):(u.parentNode.removeChild(u),u=null)}function i(){var e=new WebKitCSSMatrix(o.getComputedStyle(u,null).webkitTransform),t=s?o.scrollY-y:o.scrollY+o.innerHeight-y,i=s?o.scrollX-m:o.scrollX+Math.round((o.innerWidth-u.offsetWidth)/2)-m;t==e.m42&&i==e.m41||(u.style.webkitTransform="translate3d("+i+"px,"+t+"px,0)")}function C(){u.style.marginLeft=-Math.round(u.offsetWidth/2)-(o.orientation%180&&6<=h&&h<7?40:0)+"px"}if(t){var A,P=Date.now();if(o.addToHomeConfig)for(A in o.addToHomeConfig)b[A]=o.addToHomeConfig[A];b.autostart||(b.hookOnLoad=!1),s=/ipad/gi.test(w.platform),n=o.devicePixelRatio&&1<o.devicePixelRatio,a=/Safari/i.test(w.appVersion)&&!/CriOS/i.test(w.appVersion),r=w.standalone,h=(h=w.appVersion.match(/OS (\d+_\d+)/i))&&h[1]?+h[1].replace("_","."):0,e=+o.localStorage.getItem("addToHome"),c=o.sessionStorage.getItem("addToHomeSession"),d=!b.returningVisitor||e&&P<e+24192e5,e=e||P,l=d&&e<=P,b.hookOnLoad?o.addEventListener("load",x,!1):!b.hookOnLoad&&b.autostart&&x()}return{show:function(e){t&&!u&&(g=e,x())},close:S,reset:function(){o.localStorage.removeItem("addToHome"),o.sessionStorage.removeItem("addToHomeSession")}}}(window);!function(){var i,n,o,e,t,s,a,r,h;P.cocoon?window.cordova||(i=!1,n=[],o=function(){for(var e;e=n.shift();)e=e,console.log("Sending "+e+" to the Webview"),CocoonJS.App.forwardAsync(e)},window.gaInterfaceIsReady=function(){CocoonJS.App.forwardAsync("CocoonJS.App.show(0, 0, "+window.innerWidth*window.devicePixelRatio+","+window.innerHeight*window.devicePixelRatio+");"),i=!0,o()},console.log("Creating GAI interface"),CocoonJS.App.loadInTheWebView("https://more.gamemix.com/cocoonoverlay.html?currentGame=donttap"),window.ga=function(){for(var e="",t=0;t<arguments.length;t++)0<t&&(e+=","),e+=JSON.stringify(arguments[t]);n.push("window.ga("+e+")"),i&&o()}):(e=window,a=document,s="ga",e.GoogleAnalyticsObject=s,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,s=a.createElement("script"),a=a.getElementsByTagName("script")[0],s.async=1,s.src="//www.google-analytics.com/analytics.js",a.parentNode.insertBefore(s,a)),ga("require","displayfeatures"),ga("create","UA-50290430-1"),t=window,s=document,a="http://gmga.gamemix.com",r="gmga",t.GameMixGA=r,t[r]=t[r]||function(e){t[r].q=t[r].q||[],t[r].q.push(e)},t[r]({gmgaDomain:a}),h=s.createElement("script"),s=s.getElementsByTagName("script")[0],h.type="text/javascript",h.async=!0,h.src=a+"/client/gmga.js",s.parentNode.insertBefore(h,s),gmga("donttap")}()}();